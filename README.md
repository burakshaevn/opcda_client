# Описание

Это демонстрационный пример реализации OPC DA клиента, который работает совместно с коммуникационным сервером Эликонт-КС и расширяет его возможности. Данный пример предназначен для использования на стендах и учебных полигонах с целью изучения возможностей расширения Эликонт-КС. Автор не несет ответственности за негативные последствия, вызванные использованием данного примера.

Для начала работы нужно установить Эликонт-КС. Скачать дистрибутив для нужной ОС можно по ссылке: https://ptk-sura.ru/products/kommunikatsionnyy-server/elicont-cs/
Там же есть инструкции по установке и настройке.

>Для использования примера необходима версия Эликонт-КС не ниже 2.8.

# Процедура установки и настройки
1. На странице https://www.python.org/downloads/windows/ скачать инсталлятор Python и установить его.
>На момент разработки примера актуальной является версия python-3.13.7.exe

>**Важно:** версия Python должна быть 32bit, т.к. для OPC DA используется библиотека 32bit.

2. Установить библиотеку для работы с gRPC

Выполнить в командной строке: 
`pip install grpcio grpcio-tools`

Если Интернет доступен через прокси, то надо использовать команду:

`pip install grpcio grpcio-tools --proxy //[user:passwd@]proxy.server:port`

3. Установить библиотеку для работы с OPC DA
Выполнить в командной строке:

```
pip install OpenOPC-DA
pip install pywin32
```
4. Создать в каталог для приложения. Поместить туда файлы:

* elecont.proto - файл с описанием интерфейсов gRCP;

* gateway.py - стартовый файл для запуска обмена данными (на языке Python);

* grpc_exchange.py - файл, в котором реализован класс для обмена данными по протоколу Elecont (на языке Python);

* opcda_exchange.py - файл, в котором реализован класс для обмена данными по протоколу OPC DA (на языке Python);
* settings.ini - файл с настройками приложения

5. Для тестирования установить сервер Matrikon OPC DA Server (или другой).

6. В Конфигураторе Эликонт-КС открыть проект ... и загрузить его в КС..

7. В файле settings.ini поменять настройки, если необходимо:

Параметр | Назначение
------|-------
ELECONT_GRPC = localhost:29040 | подключение к КС
OPCDA_SERVER = Matrikon.OPC.Simulation.1 | имя сервера OPC DA
PERIOD = 1000 | период процедуры обмена данными
SYNC_MODE=0 | режим чтения данных OPC DA (0 - асинхронный, 1 - синхронный)
TAGS_LIMIT=1000	| количество тэгов OPC DA, которое может быть запрошено за 1 раз
TRACE=0	| расширенное логирование 
TIME_DELTA=0|сдвиг метки времени (для учета часового пояса)
8. Выполнить в командной строке:

`python opcda_client.py`

9. Проконтролировать обновление сигналов в Конфигураторе
>См. руководство пользователя Эликонт-КС.

10. Подключиться к КС с помощью OPC UA Expert. Проконтролировать обновление сигналов.
>Дистрибутив OPC UA Expert доступен по ссылке: https://www.unified-automation.com/downloads/opc-ua-clients.html

11. Ввести значения команды с помощью OPC UA Expert. Проконтролировать изменение соответствующего сигнала.
